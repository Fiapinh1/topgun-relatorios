<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pagina Inicial - Ano Novo Top Gun 2026</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">

    <style>
        :root {
            --primary-color: #d9b24c;
            --secondary-color: #ffffff;
            --success-color: #ffffff;
            --info-color: #d9b24c;
            --warning-color: #f4c542;
            --danger-color: #ef4444;
            --light-color: #f8fafc;
            --dark-color: #0a0f1f;
        }

        * { box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #f5f5f5;
            background: radial-gradient(circle at 10% 20%, rgba(217,178,76,0.08), transparent 32%),
                        radial-gradient(circle at 80% 0%, rgba(255,255,255,0.07), transparent 38%),
                        #060912;
        }

        /* Header Styles */
        .navbar { padding: 1rem 0; transition: all 0.3s ease; }

        .logo-container { width: 60px; height: 60px; position: relative; }

        .logo { width: 100%; height: 100%; object-fit: contain; border-radius: 8px; }

        .logo-placeholder:hover { transform: scale(1.05); }

        /* Hero Section */
        .bg-gradient-primary {
            background:
                radial-gradient(circle at 20% 20%, rgba(217,178,76,0.2), transparent 32%),
                radial-gradient(circle at 80% 8%, rgba(255,255,255,0.16), transparent 30%),
                linear-gradient(135deg, #080d1a 0%, #0c1224 50%, #0a0f1f 100%);
            position: relative;
            overflow: hidden;
        }

        .bg-gradient-primary::before {
            content: '';
            position: absolute;
            inset: 0;
            background:
                radial-gradient(2px 2px at 12% 24%, rgba(217,178,76,0.9), transparent 60%),
                radial-gradient(1.5px 1.5px at 32% 14%, rgba(255,255,255,0.75), transparent 55%),
                radial-gradient(2px 2px at 70% 30%, rgba(217,178,76,0.85), transparent 60%),
                radial-gradient(2px 2px at 84% 12%, rgba(255,255,255,0.75), transparent 55%);
            mix-blend-mode: screen;
            opacity: 0.85;
            animation: aurora 18s ease-in-out infinite;
            pointer-events: none;
        }

        .bg-gradient-primary::after {
            content: '';
            position: absolute;
            inset: -20%;
            background: radial-gradient(circle at 50% 50%, rgba(244,197,66,0.08), transparent 45%);
            filter: blur(80px);
            opacity: 0.9;
            pointer-events: none;
        }

        .hero-section { position: relative; z-index: 1; }
        .min-vh-50 { min-height: 50vh; }

        .hero-illustration { animation: float 6s ease-in-out infinite; }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(-2deg); }
            50% { transform: translateY(-18px) rotate(2deg); }
        }

        @keyframes aurora {
            0% { transform: translateY(0px) scale(1); opacity: 0.8; }
            50% { transform: translateY(-18px) scale(1.05); opacity: 1; }
            100% { transform: translateY(0px) scale(1); opacity: 0.8; }
        }

        /* Efeito de brilhos e fa√≠scas para Ano Novo */
        #sparkContainer {
            position: fixed;
            inset: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 0;
        }

        .spark {
            position: fixed;
            color: rgba(244,197,66,0.9);
            font-size: 1.1em;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-shadow: 0 0 10px rgba(244,197,66,0.65), 0 0 20px rgba(56,189,248,0.35);
            animation: sparkFloat linear infinite;
            z-index: 0;
        }

        @keyframes sparkFloat {
            0% { transform: translate3d(0, 20px, 0) scale(0.9); opacity: 0; }
            30% { opacity: 0.9; }
            100% { transform: translate3d(60px, -140px, 0) scale(1.2); opacity: 0; }
        }

        /* Navigation Cards */
        .main-nav { margin-top: -50px; position: relative; z-index: 2; }

        .nav-card {
            background: linear-gradient(135deg, rgba(255,255,255,0.07), rgba(255,255,255,0.02));
            transition: all 0.3s ease;
            border: 1px solid rgba(217,178,76,0.35) !important;
            position: relative;
            overflow: hidden;
            color: #f5f5f5;
        }

        .nav-card .text-muted { color: #e5e7eb !important; }

        .nav-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(244,197,66,0.25), transparent);
            transition: left 0.5s ease;
        }

        .nav-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.1) !important;
        }

        .nav-card:hover::before { left: 100%; }

        .nav-icon { transition: transform 0.3s ease; }
        .nav-card:hover .nav-icon { transform: scale(1.1); }

        .btn {
            border-radius: 8px;
            font-weight: 600;
            padding: 12px 24px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            transform: translate(-50%, -50%);
            transition: width 0.3s ease, height 0.3s ease;
        }

        .btn:hover::before { width: 300px; height: 300px; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0,0,0,0.2); }

        .btn-primary { background-color: #d9b24c; border-color: #c79d33; color: #0b0f1f; }
        .btn-primary:hover { background-color: #cfa53a; border-color: #b98e25; color: #0b0f1f; }

        .btn-success { background-color: #ffffff; border-color: #d9b24c; color: #0b0f1f; }
        .btn-success:hover { background-color: #f7f7f7; border-color: #c79d33; color: #0b0f1f; }

        .btn-info { background-color: #0c1224 !important; border-color: #d9b24c !important; color: #f5f5f5 !important; }
        .btn-info:hover, .btn-info:focus { background-color: #0a0f1f !important; border-color: #c79d33 !important; color: #ffffff !important; }

        /* Features Section */
        .features-section {
            background: linear-gradient(135deg, #080d1a 0%, #0c1224 40%, #0a0f1f 100%);
            color: #f5f5f5;
        }

        .feature-item {
            padding: 2rem 1rem;
            transition: transform 0.3s ease;
            background: rgba(255,255,255,0.04);
            border-radius: 14px;
            border: 1px solid rgba(217,178,76,0.2);
            box-shadow: 0 10px 30px rgba(0,0,0,0.25);
        }

        .feature-item:hover { transform: translateY(-5px); box-shadow: 0 16px 40px rgba(0,0,0,0.3); }

        .feature-icon { transition: transform 0.3s ease; color: #d9b24c; }
        .feature-item h4 { color: #ffffff; }
        .feature-item p { color: #e5e7eb; }
        .feature-item:hover .feature-icon { transform: scale(1.1) rotate(5deg); }
        .features-section .text-muted { color: #e5e7eb !important; }

        /* Footer */
        footer { background: linear-gradient(135deg, #0b1021 0%, #0f172a 100%) !important; }

        .social-links a {
            transition: all 0.3s ease;
            padding: 8px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
        }

        .social-links a:hover { background: rgba(255,255,255,0.1); transform: translateY(-2px); }

        /* Responsive Design */
        @media (max-width: 768px) {
            .display-4 { font-size: 2.5rem; }
            .display-5 { font-size: 2rem; }
            .nav-card { margin-bottom: 1rem; }
            .main-nav { margin-top: -30px; }
            .hero-section { padding: 3rem 0; }
            .logo-container { width: 50px; height: 50px; }
        }

        @media (max-width: 576px) {
            .display-4 { font-size: 2rem; }
            .lead { font-size: 1rem; }
            .btn-lg { padding: 10px 20px; font-size: 1rem; }
            .nav-card { padding: 1.5rem !important; }
        }

        /* Animations */
        .fade-in {
            opacity: 0;
            transform: translateY(30px);
            animation: fadeInUp 0.8s ease forwards;
        }

        @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }

        /* Loading Animation */
        .loading { position: relative; }
        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .loading.active::after { opacity: 1; }
        @keyframes spin { 0% { transform: rotate(0deg);} 100% { transform: rotate(360deg);} }

        /* Smooth scrolling */
        html { scroll-behavior: smooth; }

        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: var(--primary-color); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #1f2937; }

        /* Modal */
        .modal-content {
          background: linear-gradient(135deg, #0a0f1f 0%, #0c1224 100%);
          color: #f5f5f5;
          border: 1px solid rgba(217,178,76,0.35);
          box-shadow: 0 18px 45px rgba(0,0,0,0.45);
        }
        .modal-header, .modal-footer { border-color: rgba(217,178,76,0.25); }
        .modal-title { color: #f7e7a1; letter-spacing: 0.3px; }
        .modal-body label, .modal-body p { color: #e5e7eb; }
        .form-control {
          background-color: #0f1628;
          color: #f5f5f5;
          border: 1px solid rgba(217,178,76,0.35);
        }
        .form-control:focus {
          background-color: #0f1628;
          color: #ffffff;
          border-color: #d9b24c;
          box-shadow: 0 0 0 0.2rem rgba(217,178,76,0.25);
        }
        .btn-close { filter: invert(1) brightness(1.4); }

        /* Header Fixo */
        .header-fixo {
          width: 100%;
          background: linear-gradient(120deg, rgba(11,18,38,0.92), rgba(15,23,42,0.95));
          display: block;
          justify-content: center;
          align-items: center;
          padding: 12px 0;
          position: static;
          z-index: 10;
          box-shadow: 0 12px 30px rgba(0,0,0,0.35);
          backdrop-filter: blur(6px);
        }
        .logo-fixa {
          height: 46px;
          margin-right: 14px;
          filter: drop-shadow(0 6px 14px rgba(0,0,0,0.35));
        }
        .logo-selo-bandeira-row {
          display: flex;
          align-items: center;
          justify-content: space-between;
          width: 100%;
          padding: 0 24px;
          gap: 16px;
        }
        .flag-lock {
          display: flex;
          align-items: center;
          gap: 10px;
          margin-left: auto;
        }
        .flag-lock img.bandeira {
          height: 30px;
          border-radius: 6px;
          box-shadow: 0 6px 14px rgba(0,0,0,0.25);
        }
        .lock-btn {
          display: inline-flex;
          align-items: center;
          justify-content: center;
          padding: 6px 10px;
          border-radius: 999px;
          border: 1px solid rgba(255,255,255,0.65);
          background: rgba(255,255,255,0.08);
          color: #ffffff;
          cursor: pointer;
          transition: all 0.2s ease;
        }
        .lock-btn:hover {
          background: rgba(255,255,255,0.16);
          transform: translateY(-1px);
          box-shadow: 0 6px 12px rgba(0,0,0,0.18);
        }

        /* ====== NOVO: CARD RANKING ====== */
        .ranking-card {
          background: linear-gradient(135deg, rgba(255,255,255,0.08), rgba(255,255,255,0.03));
          border: 1px solid rgba(217,178,76,0.45);
          border-radius: 16px;
          box-shadow: 0 18px 45px rgba(0,0,0,0.28);
          backdrop-filter: blur(6px);
          padding: 18px;
          text-align: left;
        }
        .ranking-card .badge {
          border: 1px solid rgba(217,178,76,0.55);
          background: rgba(217,178,76,0.12);
          color: #f7e7a1;
        }
        .ranking-metric {
          background: rgba(0,0,0,0.22);
          border: 1px solid rgba(217,178,76,0.25);
          border-radius: 12px;
          padding: 10px 12px;
        }
        .ranking-table {
          width: 100%;
          border-collapse: collapse;
          margin-top: 12px;
          font-size: 0.95rem;
        }
        .ranking-table th, .ranking-table td {
          padding: 10px 10px;
          border-bottom: 1px solid rgba(255,255,255,0.10);
          vertical-align: middle;
        }
        .ranking-table th {
          color: #f7e7a1;
          font-weight: 700;
          letter-spacing: 0.2px;
          font-size: 0.85rem;
          text-transform: uppercase;
        }
        .rank-pill {
          display: inline-flex;
          align-items: center;
          justify-content: center;
          min-width: 34px;
          height: 26px;
          padding: 0 10px;
          border-radius: 999px;
          border: 1px solid rgba(217,178,76,0.55);
          background: rgba(217,178,76,0.10);
          color: #f7e7a1;
          font-weight: 800;
          font-size: 0.9rem;
        }
        .small-muted { color: #e5e7eb; opacity: 0.9; }
        .skeleton {
          background: linear-gradient(90deg, rgba(255,255,255,0.06), rgba(255,255,255,0.12), rgba(255,255,255,0.06));
          background-size: 200% 100%;
          animation: shimmer 1.4s infinite;
          border-radius: 10px;
          height: 14px;
        }
        @keyframes shimmer {
          0% { background-position: 200% 0; }
          100% { background-position: -200% 0; }
        }
    </style>
</head>

<body>
    <!-- Efeito de brilhos de Ano Novo -->
    <div id="sparkContainer"></div>

    <!-- Header Fixo -->
    <header class="header-fixo">
      <div class="logo-selo-bandeira-row">
        <img src="logo_pulvion.png" alt="Logo Pulvion" class="logo-fixa">
        <img src="logo_topgun.png" alt="Logo Top Gun" class="logo-fixa">
        <div class="flag-lock">
          <img src="https://flagcdn.com/w40/br.png" alt="Bandeira do Brasil" class="bandeira">
          <button type="button" class="lock-btn" id="lockButton" aria-label="Acesso restrito">
            <i class="bi bi-lock-fill"></i>
          </button>
        </div>
      </div>
    </header>

    <!-- Modal de senha -->
    <div class="modal fade" id="passwordModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">√Årea restrita</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
          </div>
          <div class="modal-body">
            <p class="mb-3">Digite a senha para acessar o envio de KML.</p>
            <div class="form-floating mb-2">
              <input type="password" class="form-control" id="passwordInput" placeholder="Senha" autocomplete="off" autofocus>
              <label for="passwordInput">Senha</label>
            </div>
            <div id="passwordFeedback" class="text-danger small" style="display:none;">Senha incorreta.</div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button type="button" class="btn btn-primary" id="passwordSubmit">Acessar</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Hero Section -->
    <section class="hero-section bg-gradient-primary text-white py-5">
        <div class="container">
            <div class="row align-items-center min-vh-50">
                <div class="col-lg-6">
                    <h1 class="display-4 fw-bold mb-4">Bem-vindo ao Ano Novo 2026</h1>
                    <p class="lead mb-4">
                      Entramos em um novo ciclo com energia renovada: precisao aerea, seguranca e inovacao para acelerar sua producao neste Ano Novo.
                      Conte conosco para transformar planejamento em resultados e celebrar colheitas ainda maiores em 2026.
                    </p>
                </div>

                <!-- AQUI: substitui o SVG por um CARD com ranking -->
                <div class="col-lg-6 text-center">
                    <div class="hero-illustration">
                      <div class="ranking-card mx-auto" style="max-width: 520px;">
                        <div class="d-flex align-items-start justify-content-between gap-2 mb-2">
                          <div class="text-start">
                            <div class="d-flex align-items-center gap-2">
                              <i class="bi bi-trophy-fill" style="color:#f7e7a1;"></i>
                              <h3 class="h5 fw-bold mb-0">Ranking de Aplica√ß√£o</h3>
                            </div>
                            <div class="small-muted mt-1">
                              <span id="rkPeriodPrefix">√öltimos</span> <strong id="rkPeriodLabel">7 dias</strong> (atualiza automaticamente)
                            </div>
                          </div>
                          <span class="badge rounded-pill px-3 py-2">
                            <i class="bi bi-calendar-week me-1"></i> <span id="rkBadgeText">7D</span>
                          </span>
                        </div>

                        <div class="row g-2 mt-2">
                          <div class="col-6">
                            <div class="ranking-metric text-start">
                              <div class="small-muted">√Årea total</div>
                              <div class="fw-bold" id="rkTotalArea">‚Äî</div>
                            </div>
                          </div>
                          <div class="col-6">
                            <div class="ranking-metric text-start">
                              <div class="small-muted">Voos</div>
                              <div class="fw-bold" id="rkTotalFlights">‚Äî</div>
                            </div>
                          </div>
                        </div>

                        <div class="mt-3 text-start">
                          <div class="d-flex align-items-center justify-content-between">
                            <div class="small-muted">Top pilotos</div>

                            <div class="d-flex align-items-center gap-2">
                              <select id="rkPeriod" class="form-select form-select-sm"
                                style="width:auto; background:#0f1628; color:#f5f5f5; border:1px solid rgba(217,178,76,0.35);">
                                <option value="7" selected>7 dias</option>
                                <option value="15">15 dias</option>
                                <option value="30">30 dias</option>
                                <option value="60">60 dias</option>
                                <option value="90">90 dias</option>
                                <option value="all">Tudo</option>
                                <option value="custom">Per√≠odo (datas)</option>
                              </select>

                              <button class="btn btn-sm btn-outline-light" id="rkToggleFilterBtn" type="button" style="border-color: rgba(217,178,76,0.45);">
                                <i class="bi bi-funnel me-1"></i> Filtro
                              </button>

                              <button class="btn btn-sm btn-outline-light" id="rkRefreshBtn" type="button" style="border-color: rgba(217,178,76,0.45);">
                                <i class="bi bi-arrow-clockwise me-1"></i> Atualizar
                              </button>
                            </div>
                          </div>

                          <div id="rkFilterRow" class="mt-2" style="display:none;">
                            <div class="row g-2">
                              <div class="col-6">
                                <input id="rkDateFrom" type="date" class="form-control form-control-sm" />
                              </div>
                              <div class="col-6">
                                <input id="rkDateTo" type="date" class="form-control form-control-sm" />
                              </div>
                            </div>

                            <div class="d-flex gap-2 mt-2">
                              <button class="btn btn-sm btn-outline-light" id="rkApplyRange" type="button" style="border-color: rgba(217,178,76,0.45);">
                                Aplicar
                              </button>
                              <button class="btn btn-sm btn-outline-light" id="rkClearRange" type="button" style="border-color: rgba(217,178,76,0.35); opacity:.85;">
                                Limpar
                              </button>
                            </div>

                            <div class="small-muted mt-2" id="rkRangeHint" style="opacity:.9;">
                              Dica: selecione ‚ÄúPer√≠odo (datas)‚Äù para filtrar por Data inicial/final.
                            </div>
                          </div>

                          <div id="rkLoading" class="mt-2">
                            <div class="skeleton mb-2" style="height: 18px;"></div>
                            <div class="skeleton mb-2"></div>
                            <div class="skeleton mb-2"></div>
                            <div class="skeleton mb-2"></div>
                            <div class="skeleton" style="width: 70%;"></div>
                          </div>

                          <div id="rkError" class="alert alert-danger mt-2 py-2 px-3" style="display:none; background: rgba(239,68,68,0.15); border-color: rgba(239,68,68,0.35); color:#ffd5d5;">
                            Falha ao carregar ranking.
                          </div>

                          <div id="rkTableWrap" style="display:none;">
                            <table class="ranking-table">
                              <thead>
                                <tr>
                                  <th style="width:60px;">#</th>
                                  <th>Piloto</th>
                                  <th class="text-end">√Årea</th>
                                </tr>
                              </thead>
                              <tbody id="rkTbody"></tbody>
                            </table>

                            <div class="small-muted mt-2" id="rkUpdatedAt"></div>
                          </div>
                        </div>
                      </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Main Navigation Buttons -->
    <section class="main-nav py-5">
        <div class="container">
            <div class="row g-4">
                <!-- Pulveriza√ß√£o -->
                <div class="col-lg-4 col-md-6">
                    <div class="nav-card h-100 text-center p-4 border rounded-3 shadow-sm">
                        <div class="nav-icon mb-3">
                            <div class="icon" style="margin-bottom: 12px;">
                              <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
                                <circle cx="24" cy="24" r="6" stroke="#d9b24c" stroke-width="2" fill="#fff"/>
                                <rect x="22" y="10" width="4" height="8" rx="2" fill="#d9b24c"/>
                                <rect x="22" y="30" width="4" height="8" rx="2" fill="#d9b24c"/>
                                <rect x="10" y="22" width="8" height="4" rx="2" fill="#d9b24c"/>
                                <rect x="30" y="22" width="8" height="4" rx="2" fill="#d9b24c"/>
                                <circle cx="8" cy="8" r="3" stroke="#d9b24c" stroke-width="2" fill="#fff"/>
                                <circle cx="40" cy="8" r="3" stroke="#d9b24c" stroke-width="2" fill="#fff"/>
                                <circle cx="8" cy="40" r="3" stroke="#d9b24c" stroke-width="2" fill="#fff"/>
                                <circle cx="40" cy="40" r="3" stroke="#d9b24c" stroke-width="2" fill="#fff"/>
                                <line x1="12" y1="12" x2="20" y2="20" stroke="#d9b24c" stroke-width="2"/>
                                <line x1="36" y1="12" x2="28" y2="20" stroke="#d9b24c" stroke-width="2"/>
                                <line x1="12" y1="36" x2="20" y2="28" stroke="#d9b24c" stroke-width="2"/>
                                <line x1="36" y1="36" x2="28" y2="28" stroke="#d9b24c" stroke-width="2"/>
                              </svg>
                            </div>
                        </div>
                        <h3 class="h4 mb-3">Pulveriza√ß√£o</h3>
                        <p class="text-muted mb-4">Programa√ß√£o de trabalho, e informe de rendimentos diarios.</p>
                        <button class="btn btn-primary btn-lg w-100" onclick="toggleOpcoes('pulverizacao-opcoes')">
                            <i class="bi bi-arrow-right me-2"></i>Acessar
                        </button>
                        <div id="pulverizacao-opcoes" class="opcoes" style="display:none; margin-top:10px;">
                          <button class="btn btn-outline-primary" onclick="window.location.href='programacao_aplicacao.html'">Programa√ß√£o</button>
                          <button class="btn btn-outline-primary" onclick="window.location.href='status_operacional_aplicacao.html'">Status Operacional</button>
                          <button class="btn btn-outline-primary" onclick="window.location.href='rendimento_aplicacao.html'">Rendimento</button>
                          <button class="btn btn-outline-primary" onclick="window.location.href='enc_kml_uplo.html'">Buscar KML ou PDF</button>
                        </div>
                    </div>
                </div>

                <!-- Cot√©sia -->
                <div class="col-lg-4 col-md-6">
                    <div class="nav-card h-100 text-center p-4 border rounded-3 shadow-sm">
                        <div class="nav-icon mb-3">
                            <div class="icon" style="margin-bottom: 12px;">
                              <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
                                <ellipse cx="24" cy="32" rx="6" ry="12" fill="#d9b24c" />
                                <ellipse cx="24" cy="18" rx="3" ry="5" fill="#d9b24c" />
                                <line x1="24" y1="13" x2="24" y2="8" stroke="#222" stroke-width="2" stroke-linecap="round"/>
                                <line x1="24" y1="13" x2="20" y2="6" stroke="#222" stroke-width="2" stroke-linecap="round"/>
                                <line x1="24" y1="13" x2="28" y2="6" stroke="#222" stroke-width="2" stroke-linecap="round"/>
                                <line x1="18" y1="32" x2="8" y2="40" stroke="#222" stroke-width="2" stroke-linecap="round"/>
                                <line x1="30" y1="32" x2="40" y2="40" stroke="#222" stroke-width="2" stroke-linecap="round"/>
                                <line x1="18" y1="36" x2="10" y2="46" stroke="#222" stroke-width="1.5" stroke-linecap="round"/>
                                <line x1="30" y1="36" x2="38" y2="46" stroke="#222" stroke-width="1.5" stroke-linecap="round"/>
                              </svg>
                            </div>
                        </div>
                        <h3 class="h4 mb-3">Cot√©sia</h3>
                        <p class="text-muted mb-4">Programa√ß√£o de trabalho, e informe de rendimentos diarios.</p>
                        <button class="btn btn-success btn-lg w-100" onclick="toggleOpcoes('cotesia-opcoes')">
                            <i class="bi bi-arrow-right me-2"></i>Acessar
                        </button>
                        <div id="cotesia-opcoes" class="opcoes" style="display:none; margin-top:10px;">
                          <button class="btn btn-outline-success" onclick="window.location.href='programacao_cotesia.html'">Programa√ß√£o</button>
                          <button class="btn btn-outline-success" onclick="window.location.href='status_operacional_cotesia.html'">Status Operacional</button>
                          <button class="btn btn-outline-success" onclick="window.location.href='rendimento_cotesia.html'">Rendimento</button>
                          <button class="btn btn-outline-success" onclick="window.location.href='enc_kml_uplo.html'">Buscar KML ou PDF</button>
                        </div>
                    </div>
                </div>

                <!-- Trichogramma -->
                <div class="col-lg-4 col-md-6 mx-auto">
                    <div class="nav-card h-100 text-center p-4 border rounded-3 shadow-sm">
                        <div class="nav-icon mb-3">
                            <div class="icon" style="margin-bottom: 12px;">
                              <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
                                <defs>
                                  <linearGradient id="eggShell" x1="0" y1="0" x2="0" y2="1">
                                    <stop offset="0%" stop-color="#fef6e4"/>
                                    <stop offset="100%" stop-color="#f3d8a7"/>
                                  </linearGradient>
                                </defs>
                                <path d="M24 8c-6 0-11 8-11 15s4.9 13 11 13 11-6 11-13S30 8 24 8z" fill="url(#eggShell)" stroke="#caa06a" stroke-width="2"/>
                                <path d="M34 16c-3 0-6 5-6 9s2.5 8 6 8 6-3.7 6-8-3-9-6-9z" fill="#fff3d6" stroke="#caa06a" stroke-width="1.5"/>
                                <circle cx="16" cy="30" r="5" fill="#fffbf0" stroke="#caa06a" stroke-width="1.5"/>
                                <circle cx="12" cy="36" r="3" fill="#fff5dd" stroke="#caa06a" stroke-width="1.2"/>
                              </svg>
                            </div>
                        </div>
                        <h3 class="h4 mb-3">Trichogramma</h3>
                        <p class="text-muted mb-4">Painel completo com programacao, status e rendimento.</p>
                        <button class="btn btn-info btn-lg w-100" onclick="toggleOpcoes('trichogramma-opcoes')">
                            <i class="bi bi-arrow-right me-2"></i>Acessar
                        </button>
                        <div id="trichogramma-opcoes" class="opcoes" style="display:none; margin-top:10px;">
                            <button class="btn btn-outline-info" onclick="window.location.href='programacao_trichogramma.html'">Programacao</button>
                            <button class="btn btn-outline-info" onclick="window.location.href='status_operacional_trichogramma.html'">Status Operacional</button>
                            <button class="btn btn-outline-info" onclick="window.location.href='rendimento_trichogramma.html'">Rendimento</button>
                            <button class="btn btn-outline-info" onclick="window.location.href='enc_kml_uplo.html'">Buscar KML ou PDF </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="features-section py-5">
        <div class="container">
            <div class="row text-center mb-5">
                <div class="col-lg-8 mx-auto">
                    <h2 class="display-5 fw-bold mb-3">Boas-vindas a 2026!!</h2>
                    <p class="lead text-muted">Seguimos entregando precis√£o, seguran√ßa e tecnologia a√©rea para que seu planejamento de 2026 seja ainda mais produtivo.</p>
                </div>
            </div>

            <div class="row g-4">
                <div class="col-lg-3 col-md-6">
                    <div class="feature-item text-center">
                        <div class="feature-icon mb-3">
                            <i class="bi bi-shield-check display-4 text-primary"></i>
                        </div>
                        <h4>Qualidade Garantida</h4>
                        <p class="text-muted">Servi√ßos com padr√£o de excel√™ncia e garantia de qualidade.</p>
                    </div>
                </div>

                <div class="col-lg-3 col-md-6">
                    <div class="feature-item text-center">
                        <div class="feature-icon mb-3">
                            <i class="bi bi-clock display-4 text-success"></i>
                        </div>
                        <h4>Agilidade</h4>
                        <p class="text-muted">Processos otimizados para entregas r√°pidas e eficientes.</p>
                    </div>
                </div>

                <div class="col-lg-3 col-md-6">
                    <div class="feature-item text-center">
                        <div class="feature-icon mb-3">
                            <i class="bi bi-people display-4 text-info"></i>
                        </div>
                        <h4>Suporte Especializado</h4>
                        <p class="text-muted">Equipe qualificada para atender suas necessidades.</p>
                    </div>
                </div>

                <div class="col-lg-3 col-md-6">
                    <div class="feature-item text-center">
                        <div class="feature-icon mb-3">
                            <i class="bi bi-graph-up display-4 text-warning"></i>
                        </div>
                        <h4>Resultados Comprovados</h4>
                        <p class="text-muted">Hist√≥rico de sucesso e satisfa√ß√£o dos clientes.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-dark text-white py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <p class="mb-0">&copy; 2026 Pulvion Tech. Feliz Ano Novo! üéÜ Todos os direitos reservados.</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <div class="social-links">
                        <a href="https://www.instagram.com/topgunpulverizacoes.com/" class="text-white me-3"><i class="bi bi-instagram"></i></a>
                        <a href="https://www.linkedin.com/company/top-gun-pulveriza%C3%A7%C3%B5es/" class="text-white me-3"><i class="bi bi-linkedin"></i></a>
                        <a href="mailto:tgagro@pulverizacoes.com" class="text-white">
                          <i class="bi bi-envelope"></i>
                        </a>
                        <a href="https://wa.me/5534998033258" class="text-white" target="_blank">
                          <i class="bi bi-whatsapp"></i>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // ======== CONFIG: COLE AQUI SUA URL DO APPS SCRIPT ========
        const GAS_URL = "https://script.google.com/macros/s/AKfycby1vZSlo0QbWkonHAsstQhVZNGI9R6IwN8GUgAVNuywRVTculgmaZ4_usklWnVHMwIBdA/exec";

        // Variaveis globais
        let isLoading = false;
        let passwordModal;

        function openPasswordModal() {
            const feedback = document.getElementById('passwordFeedback');
            const input = document.getElementById('passwordInput');
            if (feedback) feedback.style.display = 'none';
            if (input) input.value = '';
            if (passwordModal) {
                passwordModal.show();
                setTimeout(() => input && input.focus(), 150);
            }
        }

        function submitPassword() {
            const input = document.getElementById('passwordInput');
            const feedback = document.getElementById('passwordFeedback');
            const senha = input ? input.value : '';
            if (senha === 'topgungeo') {
                if (passwordModal) passwordModal.hide();
                window.location.href = 'painel_admin.html';
            } else {
                if (feedback) feedback.style.display = 'block';
                if (input) input.focus();
            }
        }

        // Criar efeito de brilhos de Ano Novo
        function createSparkles() {
            const sparkContainer = document.getElementById('sparkContainer');
            if (!sparkContainer) return;
            sparkContainer.innerHTML = '';

            for (let i = 0; i < 55; i++) {
                const spark = document.createElement('div');
                spark.className = 'spark';
                spark.textContent = '*';
                spark.style.top = Math.random() * window.innerHeight + 'px';
                spark.style.left = Math.random() * window.innerWidth + 'px';
                spark.style.opacity = (Math.random() * 0.5 + 0.3).toFixed(2);
                spark.style.fontSize = Math.random() * 14 + 10 + 'px';
                spark.style.color = Math.random() > 0.4 ? 'rgba(244,197,66,0.9)' : 'rgba(56,189,248,0.8)';
                spark.style.animationDuration = (Math.random() * 8 + 10).toFixed(1) + 's';
                spark.style.animationDelay = (Math.random() * 5).toFixed(2) + 's';
                sparkContainer.appendChild(spark);
            }
        }

        function showLoading(button) {
            if (!button) return;
            isLoading = true;
            button.classList.add('loading', 'active');
            button.disabled = true;
            button.innerHTML = '<i class="bi bi-hourglass-split me-2"></i>Carregando.';
        }

        function hideLoading(button) {
            if (!button) return;
            isLoading = false;
            button.classList.remove('loading', 'active');
            button.disabled = false;
            button.innerHTML = '<i class="bi bi-arrow-right me-2"></i>Acessar';
        }

        function showNotification(message, type = 'info') {
            const existingNotification = document.querySelector('.notification');
            if (existingNotification) existingNotification.remove();

            const notification = document.createElement('div');
            notification.className = `notification alert alert-${type === 'error' ? 'danger' : type} position-fixed top-0 start-50 translate-middle-x mt-3`;
            notification.style.zIndex = '9999';
            notification.innerHTML = `
                <div class="d-flex align-items-center">
                    <i class="bi bi-info-circle me-2"></i>
                    <span>${message}</span>
                    <button type="button" class="btn-close ms-3" aria-label="Close"></button>
                </div>
            `;

            document.body.appendChild(notification);

            const closeBtn = notification.querySelector('.btn-close');
            closeBtn.addEventListener('click', () => notification.remove());

            setTimeout(() => {
                if (notification.parentNode) notification.remove();
            }, 4000);
        }

        function isMobile() {
            return window.innerWidth <= 768;
        }

        function optimizeForMobile() {
            // Ajustes extras se precisar
        }

        // ======== NOVO: JSONP para GitHub Pages (sem CORS) ========
        function loadJsonp(url) {
          return new Promise((resolve, reject) => {
            const cbName = "cb_" + Math.random().toString(36).slice(2);
            const script = document.createElement("script");

            window[cbName] = (data) => {
              cleanup();
              resolve(data);
            };

            const cleanup = () => {
              try { delete window[cbName]; } catch(e) { window[cbName] = undefined; }
              if (script && script.parentNode) script.parentNode.removeChild(script);
            };

            script.onerror = () => {
              cleanup();
              reject(new Error("Falha ao carregar JSONP"));
            };

            const sep = url.includes("?") ? "&" : "?";
            script.src = url + sep + "callback=" + encodeURIComponent(cbName) + "&_=" + Date.now();
            document.body.appendChild(script);
          });
        }

        function fmtNumber(n, decimals = 2) {
          const num = Number(n);
          if (!isFinite(num)) return "0";
          return num.toLocaleString("pt-BR", { minimumFractionDigits: decimals, maximumFractionDigits: decimals });
        }

        function fmtInt(n) {
          const num = Number(n);
          if (!isFinite(num)) return "0";
          return num.toLocaleString("pt-BR");
        }

        function showRankingLoading(on) {
          const elLoading = document.getElementById("rkLoading");
          const elWrap = document.getElementById("rkTableWrap");
          const elErr = document.getElementById("rkError");
          if (elLoading) elLoading.style.display = on ? "block" : "none";
          if (elWrap) elWrap.style.display = on ? "none" : (elWrap.dataset.hasData === "1" ? "block" : "none");
          if (elErr) elErr.style.display = "none";
        }

        function showRankingError(msg) {
          const elErr = document.getElementById("rkError");
          const elLoading = document.getElementById("rkLoading");
          const elWrap = document.getElementById("rkTableWrap");
          if (elLoading) elLoading.style.display = "none";
          if (elWrap) elWrap.style.display = "none";
          if (elErr) {
            elErr.textContent = msg || "Falha ao carregar ranking.";
            elErr.style.display = "block";
          }
        }

        async function fetchRanking() {
          showRankingLoading(true);

          try {
            const url = buildRankingUrl_();
            const data = await loadJsonp(url);

            // GAS retorna array ou {ok:false,message:"..."}
            if (!data) throw new Error("Resposta vazia");
            if (data.ok === false) throw new Error(data.message || "Erro no servidor");

            const list = Array.isArray(data) ? data : (data.data || []);
            if (!Array.isArray(list) || list.length === 0) {
              // sem dados
              document.getElementById("rkTotalArea").textContent = "0,00 ha";
              document.getElementById("rkTotalFlights").textContent = "0";
              const wrap = document.getElementById("rkTableWrap");
              if (wrap) { wrap.dataset.hasData = "0"; wrap.style.display = "none"; }
              showRankingLoading(false);
              return;
            }

            // totais
            const totalArea = list.reduce((s, x) => s + (Number(x.area) || 0), 0);
            const totalFlights = list.reduce((s, x) => s + (Number(x.flights) || 0), 0);

            document.getElementById("rkTotalArea").textContent = `${fmtNumber(totalArea, 2)} ha`;
            document.getElementById("rkTotalFlights").textContent = fmtInt(totalFlights);

            // top 5
            const top = list.slice(0, 5);
            const tbody = document.getElementById("rkTbody");
            tbody.innerHTML = "";

            top.forEach((x, i) => {
              const tr = document.createElement("tr");

              const tdRank = document.createElement("td");
              tdRank.innerHTML = `<span class="rank-pill">${i + 1}</span>`;

              const tdPilot = document.createElement("td");
              tdPilot.innerHTML = `
                <div class="fw-semibold">${(x.pilot || "SEM PILOTO")}</div>
                <div class="small-muted">Voos: <strong>${fmtInt(x.flights || 0)}</strong> ‚Ä¢ L/ha: <strong>${fmtNumber(x.lpha || 0, 2)}</strong></div>
              `;

              const tdArea = document.createElement("td");
              tdArea.className = "text-end";
              tdArea.innerHTML = `<div class="fw-bold">${fmtNumber(x.area || 0, 2)} ha</div>`;

              tr.appendChild(tdRank);
              tr.appendChild(tdPilot);
              tr.appendChild(tdArea);
              tbody.appendChild(tr);
            });

            const wrap = document.getElementById("rkTableWrap");
            if (wrap) { wrap.dataset.hasData = "1"; wrap.style.display = "block"; }

            const updated = document.getElementById("rkUpdatedAt");
            if (updated) {
              const now = new Date();
              updated.textContent = `Atualizado em ${now.toLocaleString("pt-BR")}`;
            }

            showRankingLoading(false);
          } catch (err) {
            console.error(err);
            showRankingError("Falha ao carregar ranking.");
          }
        }

        // Estado do filtro do ranking (padr√£o: √∫ltimos 7 dias)
        const rkState = {
          mode: "period",      // "period" | "range"
          periodDays: "7",      // "7", "15", "30", "60", "90", "all"
          dateFrom: "",         // "YYYY-MM-DD"
          dateTo: ""            // "YYYY-MM-DD"
        };

        function buildRankingUrl_() {
          const qs = new URLSearchParams();
          qs.set("action", "getRanking");

          if (rkState.mode === "range" && (rkState.dateFrom || rkState.dateTo)) {
            if (rkState.dateFrom) qs.set("dateFrom", rkState.dateFrom);
            if (rkState.dateTo) qs.set("dateTo", rkState.dateTo);
          } else {
            qs.set("periodDays", rkState.periodDays || "7");
          }

          return `${GAS_URL}?${qs.toString()}`;
        }

        function updateRankingPeriodUI_() {
          const prefixEl = document.getElementById("rkPeriodPrefix");
          const labelEl = document.getElementById("rkPeriodLabel");
          const badgeEl = document.getElementById("rkBadgeText");

          if (!prefixEl || !labelEl || !badgeEl) return;

          if (rkState.mode === "range" && (rkState.dateFrom || rkState.dateTo)) {
            prefixEl.textContent = "Per√≠odo";
            const a = rkState.dateFrom ? rkState.dateFrom.split("-").reverse().join("/") : "‚Äî";
            const b = rkState.dateTo ? rkState.dateTo.split("-").reverse().join("/") : "‚Äî";
            labelEl.textContent = `${a} a ${b}`;
            badgeEl.textContent = "DATA";
          } else {
            prefixEl.textContent = "√öltimos";
            const p = rkState.periodDays || "7";
            labelEl.textContent = (p === "all") ? "tudo" : `${p} dias`;
            badgeEl.textContent = (p === "all") ? "ALL" : `${p}D`;
          }
        }


        function debugInfo() {
            console.log('Pagina carregada com sucesso!');
            console.log('Dispositivo movel:', isMobile());
            console.log('Versao do navegador:', navigator.userAgent);
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Modal bootstrap
            const modalEl = document.getElementById('passwordModal');
            if (modalEl) passwordModal = new bootstrap.Modal(modalEl);

            // Sparkles
            createSparkles();
            optimizeForMobile();

            // Bot√£o lock
            const lockButton = document.getElementById('lockButton');
            if (lockButton) {
                lockButton.addEventListener('click', openPasswordModal);
                lockButton.title = 'Area restrita';
            }

            const passwordSubmit = document.getElementById('passwordSubmit');
            if (passwordSubmit) passwordSubmit.addEventListener('click', submitPassword);

            const passwordInput = document.getElementById('passwordInput');
            if (passwordInput) {
                passwordInput.addEventListener('keydown', (e) => {
                    if (e.key === 'Enter') {
                        e.preventDefault();
                        submitPassword();
                    }
                });
            }

            // T√≠tulos √≠cones sociais
            document.querySelectorAll('.social-links a').forEach(link => {
                const icon = link.querySelector('i');
                if (icon) {
                    if (icon.classList.contains('bi-facebook')) link.title = 'Facebook';
                    else if (icon.classList.contains('bi-instagram')) link.title = 'Instagram';
                    else if (icon.classList.contains('bi-linkedin')) link.title = 'LinkedIn';
                    else if (icon.classList.contains('bi-envelope')) link.title = 'Email';
                    else if (icon.classList.contains('bi-whatsapp')) link.title = 'WhatsApp';
                }
            });

            setTimeout(() => {
                showNotification('Boas-vindas a 2026! Vamos decolar juntos.', 'info');
            }, 1000);

            // Carrega ranking autom√°tico (padr√£o: √∫ltimos 7 dias)
            updateRankingPeriodUI_();
            fetchRanking();

            // Bot√£o atualizar ranking
            const btn = document.getElementById("rkRefreshBtn");
            if (btn) btn.addEventListener("click", fetchRanking);

            // Controles de filtro
            const sel = document.getElementById("rkPeriod");
            const toggle = document.getElementById("rkToggleFilterBtn");
            const filterRow = document.getElementById("rkFilterRow");
            const inFrom = document.getElementById("rkDateFrom");
            const inTo = document.getElementById("rkDateTo");
            const btnApply = document.getElementById("rkApplyRange");
            const btnClear = document.getElementById("rkClearRange");

            if (toggle && filterRow) {
              toggle.addEventListener("click", () => {
                filterRow.style.display = (filterRow.style.display === "none" || !filterRow.style.display) ? "block" : "none";
              });
            }

            if (sel) {
              sel.addEventListener("change", () => {
                const v = sel.value || "7";
                if (v === "custom") {
                  rkState.mode = "range";
                  // abre a √°rea de datas pra pessoa escolher
                  if (filterRow) filterRow.style.display = "block";
                } else {
                  rkState.mode = "period";
                  rkState.periodDays = v;
                  rkState.dateFrom = "";
                  rkState.dateTo = "";
                  if (inFrom) inFrom.value = "";
                  if (inTo) inTo.value = "";
                  updateRankingPeriodUI_();
                  fetchRanking();
                }
              });
            }

            if (btnApply) {
              btnApply.addEventListener("click", () => {
                const from = (inFrom && inFrom.value) ? inFrom.value : "";
                const to = (inTo && inTo.value) ? inTo.value : "";
                if (!from && !to) {
                  if (typeof showNotification === "function") {
                    showNotification("Selecione a data inicial e/ou final.", "warning");
                  } else {
                    alert("Selecione a data inicial e/ou final.");
                  }
                  return;
                }
                rkState.mode = "range";
                rkState.dateFrom = from;
                rkState.dateTo = to;
                if (sel) sel.value = "custom";
                updateRankingPeriodUI_();
                fetchRanking();
              });
            }

            if (btnClear) {
              btnClear.addEventListener("click", () => {
                rkState.mode = "period";
                rkState.periodDays = "7";
                rkState.dateFrom = "";
                rkState.dateTo = "";
                if (sel) sel.value = "7";
                if (inFrom) inFrom.value = "";
                if (inTo) inTo.value = "";
                if (filterRow) filterRow.style.display = "none";
                updateRankingPeriodUI_();
                fetchRanking();
              });
            }

            debugInfo();
        });

        window.addEventListener('resize', function() {
            optimizeForMobile();
            createSparkles();
        });

        window.addEventListener('error', function(e) {
            console.error('Erro capturado:', e.error);
            showNotification('Ocorreu um erro inesperado. Tente novamente.', 'error');
        });

        function toggleOpcoes(id) {
          document.querySelectorAll('.opcoes').forEach(div => {
            if (div.id !== id) div.style.display = 'none';
          });
          const opcoes = document.getElementById(id);
          if (opcoes) {
            opcoes.style.display = opcoes.style.display === 'none' ? 'block' : 'none';
          }
        }
    </script>
</body>
</html>


